// 2016.12.12 charset.utf-8

var _hmt = _hmt || [];
(function(){
  var hm = document.createElement("script");
  hm.src = "//hm.baidu.com/hm.js?7e80268b0a1d4928123e36ba0db82f77";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();


$.cachedScript = function(a, b){
	b = $.extend(b || {}, {dataType: "script", cache: true, url: a});
	return $.ajax(b);
};


var f_cbr = function(a, b){
	if(typeof f_cb[a] == 'function'){
		if(b) f_cb[a](b);
		else f_cb[a]();
	}
}

var f_cb = {};
f_cb.datetime = function(){
	var a = (new Date())._format('{y}年{m}月{d}日 {week} {nongli}');
	$('.js-datetime').html(a);
};

f_cb.city = function(){
	City.Init();
};

f_cb.fag = function(a){
	if(a.mod == 'ph' && a.bgimg){
		var b = new Image();
		b.onload = function(){
			var c = $('.toplogo');
			var b = $('<a></a>');
			b.css({height: a.height + 'px', display: 'block'}).attr('href', a.href).attr('target', '_blank');
			c.before(b);
			c.add('.topnav1').add('.topnav2').add('.topnav3-4').addClass('maincenter');
			$('body').css({background: 'url(' + a.bgimg + ') no-repeat center 35px'});
		};
		b.src = a.bgimg;
	}
};

var fagbyid = function(a, b, c){
	var s = "_" + Math.random().toString(36).slice(2);
    document.write('<div id="' + s + '"></div>');
    (window.slotbydup = window.slotbydup || []).push({id: a, container: s, size: b + ',' + c, display: 'inlay-fix'});
};

f_cb.so = function(z){
	$(z.f).bind('submit', function(){
		var a = $(z.q, $(this)), b = a.length > 0 ? a.val() : '';
		if(b == ''){
			alert('请输入关键字');
			a.focus();
			return false;
		}
		return true;
	});
};

f_cb.gd = function(z){
	var a, b, c, d = $(z.id), e = 0, f, g = d.height(), h, i, j = 3000, o, q, r;
	if(z.conid) a = $(z.conid);
	else a = d.children().eq(0);
	if(z.upid) b = $(z.upid);
	if(z.downid) c = $(z.downid);
	f = a.height();
	h = Math.round(f / g) - 1;
	if(z.autotime) j = z.autotime;
	o = function(p){
		e = e + p; 
		if(e < 0) e = h;
		if(e > h) e = 0;
		a.stop().animate({marginTop: (-e * g) + 'px'}, function(){
			q();
			r();
		});
	};	
	q = function(){
		clearTimeout(i);
	};
	r = function(){
		i = setTimeout(function(){
			o(1);
		}, j);
	};
	if(b) b.bind('click', function(){
		o(-1);
	});
	if(c) c.bind('click',function(){
		o(1);
	});
	a.hover(q, r);
	r();
}

f_cb.nav234 = function(){
	var d, h, e = $('.topnav3-4'), f = function(a){
		clearTimeout(d);
		d = setTimeout(function(){
			g(a);
		}, 3000);
	}, g = function(a){
		a.hide();
	};
	$('.topnav2 .o').each(function(){
		$(this).hover(function(){
			var a = $(this), b = $(a.attr('data'));
			a.addClass('p');
			e.hide();
			b.show();
		}, function(){
			var a = $(this),
			b = $(a.attr('data'));
			a.removeClass('p');
			f(b);
		});
	});
	e.hover(function(){
		clearTimeout(d);
	}, function(){
		f($(this));
	});
};

f_cb.tt_more = function(){
	var a = $('.moretoutiao ul'), b = function(){
		if (g == 0) return ;
		f = f + 0.5;
		if(f > c) f = 0;
		e();
	}, c = 0, d, e = function(){
		a.css({marginLeft: (-f) + 'px'});
		g = setTimeout(function(){
			b();
		}, 20);
	}, f = 0, g;
	a.children().each(function(){
		var d = $(this), e = d.clone();
		c = c + 20 + d.width();
		a.append(e);
	});
	a.css({width: (c * 3) + 'px'});
	b();
	a.hover(function(){
		clearTimeout(g);
	}, function(){
		b();
	});
};

f_cb.tab = function(z){
	var a = $(z.a), b = (typeof z.b == 'function') ? 1 : 0;
	if(!b) var c = $(z.b);
	else z.b(0);
	a.each(function(){
		var y = $(this);
		y.bind('mouseover', function(){
			var x = $(this),
			w = x.attr('data');
			if(!b){
				c.hide();
				c.each(function(){
					var a = $(this);
					if(a.attr('data') == w) a.show();
				});
			}else z.b(w);
			a.removeClass(z.onClass);
			x.addClass(z.onClass);
		});
	});
};


f_cb.jdtload = function(o){
	var b = $(o.id), c = $('.jdt-data', b), d = c.find('a'), e = d.length, su = '<ul></ul>', si = '<li></li>', se = '<em></em>', sd = '<div></div>', sif = '<iframe></iframe>', f = $(su), g = $(su), h = b.width(), i = b.height(), j = 5, k = i - o.titleHeight - o.dianWidth - o.dianPadding - 10, l = 0, d1 = 0, d2 = 0, m = function(){
		l++;
		if(l >= e) l=0;
		n(l);
	}, mf = function(){
		l--;
		if(l < 0) l = e - 1;
		n(l);
	}, n = function(a){
		l = a;
		var c = g.children();
		c.removeClass('on');
		c.eq(l).addClass('on');
		f.stop().animate({marginLeft: (-l * h) + 'px'}, function(){
			q();
		});
	}, p, q = function(){
		r();
		s();
	}, r = function(){
		clearTimeout(p);
	}, s = function(){
		p = setTimeout(m, o.autoTime);
	}, t = $(sd), x = function(a){
		var f = $(sif), g = $(sd), w = $(window), sf = function(){
			var t = w.scrollTop();
			if(t >= i + O.top){
				if(Y == 0){
					Y = 1;
					f.css({position: 'fixed', left: '5px', bottom: '5px', width: '345px', height:'197px'});
					g.css({position: 'fixed', left: '350px', bottom: '186px', top:'auto', right:'auto'});
				}
			}else{
				if(Y == 1){
					Y = 0;
					f.css({position: 'absolute', left: 'auto', bottom: 'auto', width: h + 'px', height: i + 'px'});
					g.css({position: 'absolute', left: 'auto', bottom:'auto', top: 0, right: '-16px'});
				}
			}
		};
		y = 0;
		r();
		f.css({position: 'absolute', zIndex: 5, width: h + 'px', height: i + 'px'}).attr('src', 'http://cdn.media.fjsen.com/player/?vid=' + encodeURIComponent(a) + '&auto=1').attr('allowfullscreen','true');
		g.addClass('tvOff').click(function(){
			w.unbind('scroll', sf);
			f.remove();
			g.remove();
			y = 1;
			s();
		});
		b.append(f).append(g);
		Y = 0;
		w.bind('scroll', sf);
	}, y = 1, O = b.offset(), Y = 0;
	c.remove();
	f.addClass('jdt-img');
	g.addClass('jdt-dian');
	d.css({display:'block', width: h + 'px', height: i + 'px'});
	d.each(function(y, z){
		var a = $(this), b = $(sd), c = $(si), d = $(si), e = $(se), u = a.attr('data') || '', v = $(sd);
		if(y == 0) d.addClass('on');
		b.css({width: h + 'px', height: o.titleHeight + 'px', lineHeight: o.titleHeight + 'px', left: 0, bottom: 0, fontSize: o.fontSize + 'px', position: 'absolute'}).html(a.attr('title')).addClass('touming');
		a.find('img').css({width: h + 'px', height: i + 'px'});
		c.css({width: h + 'px', height: i + 'px', float: 'left', position: 'relative'});
		e.css({width: o.dianWidth + 'px', height: o.dianWidth + 'px', borderRadius: o.borderRadius + 'px'});
		d.css({width: o.dianWidth + 'px', height: o.dianWidth + 'px', padding: o.dianPadding + 'px', float: 'left', cursor: 'pointer'}).data('y', y).bind(o.dianEvent, function(){
			n($(this).data('y'));
		});
		u = u.replace(/<[^>]*?>/ig, '');
		if(u.match(/(^http|\w{32})/i)){
			v.addClass('tvPlay').css({left: (h - 85) / 2 + 'px', top: (i - 85) / 2 + 'px'});
			a.append(v);
			a.click(function(e){
				e.preventDefault();
				x(u);
				return false;
			});
		}
		a.append(b);
		c.append(a);
		f.append(c);
		d.append(e);
		g.append(d);
	});
	if(o.dianPosition == 'center') j = (h - (o.dianWidth + o.dianPadding * 2) * e) / 2;
	if(o.dianPosition == 'right') j = (h - (o.dianWidth + o.dianPadding * 2) * e) - 5;
	f.css({width: (h * e) + 'px'});
	g.css({left: j + 'px', top: k, position: 'absolute', zIndex: 3});
	
	Drag.add(f, function(e){
		d1 = d2 = e.x;
		f.removeClass('disabled');
	}, function(e){
		var a = e.x - d2, b = Math.abs(e.x - d1);
		d2 = e.x;
		if(b > 10) f.addClass('disabled');
		f.css({'margin-left': (a + parseInt(f.css('margin-left'))) + 'px'});
	}, function(){
		var a = d2 - d1, b = Math.abs(a);
		f.removeClass('disabled');
		if(b > 80){
			if(a > 0) mf();
			else m();
		}else{
			if(b > 0) n(l);
		}
	});
	
	t.css({width: h + 'px', height: i + 'px', overflow:'hidden', position: 'absolute', zIndex: 1}).append(f);
	b.css({position: 'relative'}).append(g).append(t);
	b.hover(r, function(){
		if(y) s();
	});
	if(o.autoTime) s();
};


var Drag = {
	is: 0, op: 0, n: -1, aL: [], bL: [], cL: [], dL:[], it: 0, touch: {start: 'mousedown', move: 'mousemove', end: 'mouseup'}, add: function(a, b, c, d){
		if(Drag.is == 0) Drag.install();
		Drag.aL.push(a);
		Drag.bL.push(b);
		Drag.cL.push(c);
		Drag.dL.push(d);
		a.data('DragID', 'Drag_' + (Drag.aL.length - 1)).bind(Drag.touch.start, function(e){
			Drag.start(e, $(this));
		});
	}, start: function(e, a){
		if(!Drag.it) e.preventDefault();
		Drag.n = -1;
		for(var i in Drag.aL){
			if(a.data('DragID') == Drag.aL[i].data('DragID')){
				Drag.n = i;
				break;
			}
		}
		if(Drag.n >= 0){
			Drag.op = 1;
			Drag.bL[Drag.n](Drag.xy(e));
		}
	}, xy: function(e){
		if(Drag.it) e=e.originalEvent.targetTouches[0];
		return {x: e.pageX, y: e.pageY};
	}, install: function(){
		Drag.is = 1;
		Drag.it = 'ontouchstart' in window;
		if(Drag.it) Drag.touch = {start: 'touchstart', move: 'touchmove', end: 'touchend'};
		$(document).bind(Drag.touch.move, function(e){
			if(Drag.op == 0) return ;
			Drag.cL[Drag.n](Drag.xy(e));
		}).bind(Drag.touch.end, function(e){
			if(Drag.op == 0) return ;
			Drag.op = 0;
			Drag.dL[Drag.n]();
		});	
	}
};

f_cb.dingzhi = function(){
	var a = $('.dingzhi'), b = $('.dingzhibar'), c = $('.top', b), d = $('.bottom', b), e = $('li', b), qq = $('.pagebottom'), g = function(a){
		a = a - 30;
		if(a < 0) a = 0;
		var b = w.scrollTop(), c = Math.abs(a - b), d = 600;
		if(c < 100) return ;
		if(c > 2000) d = 900;
		if(c > 5000) d = 1200;
		$('html').add('body').animate({scrollTop: a + 'px'}, d);
	}, h = Cookie('dz'), j = [], k = function(a){
		return Math.round(parseInt(a) - 1);
	}, l = function(a, b){
		var c = 1, d = [];
		for(var i in j){
			if(a == j[i]) c = 0;
			else d.push(j[i]);
		}
		if(c && b) d.push(a);
		j = d;
		h = j.join(',');
		Cookie('dz', h);
	}, w = $(window), v = w.width();
	a.each(function(){
		var z = $(this), y = $('.off', z);
		y.click(function(){
			var a = z.attr('data');
			l(a, 1);
			z.stop().slideUp();
			e.eq(k(a)).addClass('off');
		});
	});
	if(h){
		j = h.split(',');
		for(var i in j){
			var q = k(j[i]);
			a.eq(q).hide();
			e.eq(q).addClass('off');
		}
	}
	e.click(function(){
		var z = $(this), y = z.attr('data'), x = a.eq(k(y));
		z.removeClass('off');
		l(y, 0);
		if(x.is(':hidden')) x.stop().slideDown();
		g(x.offset().top);
	}).hover(function(){
		$(this).addClass('on');
	}, function(){
		$(this).removeClass('on');
	});
	c.click(function(){
		g(0);
	});
	d.click(function(){
		g(qq.offset().top);
	});
	if(v > 0 && v < 1181) b.css({marginLeft: 'auto', right: '10px'});
	w.bind('scroll', function(){
		var s = w.scrollTop(), t = qq.offset().top, h = b.height(), k = w.height(), l = t - k, o = t - h - 5;
		if(s > l) b.css({position: 'absolute', top: o + 'px'});
		else b.css({position: 'fixed', top: 'auto'});
	});
};

f_cb.yqlj = function(){
	var a = function(a){
		var b = a.children('ul');
		if(b.length > 0) b.show();
		if(!!a.data('install'))	return ;
		a.data('install', 1);
		b = $('<ul></ul>');
		var c = a.offset(), d = c.left, e = c.top, f = a.innerWidth(), g = a.attr('g') || '', k = a.html(), l = 0, m = [], n = linkdata, p = parseInt(a.attr('p') || 0);
		if(g != ''){
			d = d + f;
			m = g.split(',');
		}
		m.push(k);
		for(var i in m){
			n = n[m[i]];
		}
		for(var i in n){
			var h = n[i], j = $('<li></li>');
			j.css({borderBottom: '1px solid #e0e0e0', borderRight: '1px solid #e0e0e0'});
			if(h.a) {
				j.html('<a href="' + h.a + '" ' + (h.c == '' ? '' : 'class="' + h.c + '"') + ' target="_balnk">' + h.b + '</a>');	
				j.hover(cc, bb);
			}else{
				j.html(i);
				j.attr('g', m.join(','));
				j.attr('p', l);
				j.hover(cc, bb);
			}
			b.append(j);
			l++;
		}
		if(g == '') e = e - l * 31;
		else{
			e = p * 31;
			d = f;
		}
		b.css({position: 'absolute', zIndex: 9999, textAlign: 'center', background: '#f4f4f4', borderTop: '1px solid #e0e0e0', borderLeft: '1px solid #e0e0e0', left: d + 'px', top: e + 'px', width: f + 'px'});
		a.append(b);
	}, bb = function(){
		var a = $(this), b = a.children('ul');
		a.css({background:'#f4f4f4'});
		if(b.length > 0) b.hide();
	}, cc = function(){
		var b = $(this);
		b.css({background:'#cafdf7'});
		if(d == 0){
			d = 1;
			$.cachedScript('http://www.fjsen.com/js/linkdata.js').done(function(){
				e = 1;
				a(b);
			});
		}else if(e == 1) a(b);
	}, d = 0, e = 0;
	$('.yqlj').hover(cc, bb);
};

f_cb.dbtp = function(){
	document.write('<a href="http://www.12377.cn/" target="_blank" class="btli_00"></a>&nbsp;<a href="//bszs.conac.cn/sitename?method=show&id=0A505678ACEF4A53E053022819ACFD83" target="_blank" class="btli_1"></a>'
	+ '&nbsp;<a href="http://www.12377.cn/" target="_blank" class="btli_2"></a>&nbsp;<a href="http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=35010202000686" target="_blank" class="gaba"></a>');
};


f_cb.end = function(){
	$('.strongul').each(function(){
		var a = $(this), b = a.attr('data'), c = b.split(','), d = a.children();
		for(var i in c){
			d.eq(c[i]).addClass('strongli');
		}
	})
	ToGbk.LoadBig();
	if(typeof console.log == 'function'){
		var z = ['一张网页，要经历怎样的过程，才能抵达用户面前？', '一位新人，要经历怎样的成长，才能站在技术之巅？', '探寻这里的秘密；', '体验这里的挑战；', '成为这里的主人；', '加入东南网，你，可以影响世界。', '请将简历发送至  hr@fjsen.com（ 邮件标题请以“姓名-应聘XX职位-来自console”命名）', '电话：0591-87079312'];
		for(var i in z){
			console.log(z[i]);
		}
	}
	$.cachedScript('http://www.baidu.com/js/opensug.js', {scriptCharset:'gbk'});
};

f_cb.topclick = function(){
	ToGbk.Load();
	$('.js-jianfan').bind('click', function(e){
		e.preventDefault();
		$(this).html(ToGbk.Toggle());
		return false;
	}).html(ToGbk.TextName());	
	$('.js-favorite').bind('click', function(e){
		e.preventDefault();
		var a = location.href, b = document.title, c = false;
		try{
			window.external.addFavorite(a, b);
			c = true;
		}catch(e){
			c=false;
		}
		try{
			window.sidebar.addPanel(b, a, "");
			c = true;
		}catch(e){
			c=false;
		}
		if(!c) alert("此操作被浏览器拒绝！\n请使用Ctrl+D收藏");
		return false;
	});
	$('.js-homepage').bind('click', function(e){
		e.preventDefault();
		var a = location.href;
		if(document.all){
			document.body.style.behavior = 'url(#default#homepage)';
			document.body.setHomePage(a);
		}else if(window.sidebar){
			if(window.netscape){
				try{
					netscape.security.PrivilegeManager.enablePrivilege("UniversalXPConnect");
			}catch(e){
				alert("此操作被浏览器拒绝！\n请在浏览器地址栏输入“about:config”并回车\n然后将 [signed.applets.codebase_principal_support]的值设置为true,双击即可。");
				return false;
			}
		}
		var prefs = Components.classes['@mozilla.org/preferences-service;1'].getService(Components.interfaces.nsIPrefBranch);
		prefs.setCharPref('browser.startup.homepage', a);}
		return false;
	});
}


function GetQueryString(n){
     var r = new RegExp("(^|&)" + n + "=([^&]*)(&|$)"), g = window.location.search.substr(1).match(r);
     if(g == null) return null;
	 return decodeURIComponent(g[2]);
}


var City = {
	CookieName: 'city', Init: function(){
		var t = GetQueryString('city') || Cookie(City.CookieName);
		if(t != null && t != '') City.Set(t);
		else City.Get();
	}, Get: function(){
		/*$.getScript('http://int.dpool.sina.com.cn/iplookup/iplookup.php?format=js', function(){
			City.Set(remote_ip_info.city);
		});*/
		$.getScript('http://pv.sohu.com/cityjson?ie=utf-8', function(){
			var t = returnCitySN.cname.replace(/(^.*省|市.*$)/ig, '');
			City.Set(t);
		});
	}, Set: function(t){
		Cookie(City.CookieName, t, 1800, 'fjsen.com', '/');
		City.Run(t);
	}, Run:function(t){
		Weather.Init('.js-weather', t);
	}
};

var Weather = {
	Url: 'http://map.baidu.com/?qt=cur&wd={city}&callback=?', City: '', Selector: '', Data: {}, isNight: 1, Init: function(s, t){
		Weather.Selector = s;
		Weather.City = t;
		Weather.Get();
	}, Get: function(){
		$.getJSON(Weather.Url.replace('{city}', Weather.City), function(json){
			Weather.parseData(json);
			Weather.toSelector();
		});
	}, parseDu: function(t){
		return '<a href="http://news.fjsen.com/weather.htm" target="_blank">' + t + '</a>';
	}, parseImg: function(w){
		var z = '', h = (new Date()).getHours(), c = function(w, s, a){
			if(escape(s).toString().toLowerCase().replace(/%/g, '\\') == w.replace(/\\\\u8f6c.*$/, '') || s == w.replace(/转.*$/, '')){
				z=a;
				return false;
			}else{
				z='';
				return true;
			}
		};
		c(w, '晴', '0') && c(w, '多云','1') && c(w, '阴', '2') && c(w, '阵雨', '33') && c(w, '雷阵雨', '34') && c(w, '雷阵雨伴有冰雹', '5') && c(w, '雨夹雪', '6') && c(w, '小雨', '7') && c(w, '中雨', '8') && c(w, '大雨', '9') && c(w, '暴雨', '10') && c(w, '大暴雨', '11') && c(w, '特大暴雨', '12') && c(w, '阵雪', '13') && c(w, '小雪', '14') && c(w, '中雪', '15') && c(w, '大雪', '16') && c(w, '暴雪', '17') && c(w, '雾', '18') && c(w, '冻雨', '19') && c(w, '沙尘暴', '20') &&	c(w, '小到中雨', '21') && c(w, '中到大雨', '22') && c(w, '大到暴雨', '23') && c(w, '暴雨到大暴雨', '24') && c(w, '大到特大暴雨', '25') && c(w, '小到中雪', '26') && c(w, '中到大雪', '27') && c(w,'大到暴雪', '28') && c(w, '浮尘', '29') && c(w, '扬沙', '30') && c(w, '强沙尘暴', '31') && c(w, '霾', '32');
		if(z != ''){
			z = (Weather.isNight && (z == '0' || z == '1') && (h > 18 || h < 6)) ? z + '_night.jpg' : z + '.png';
			return '<img src="http://www.fjsen.com/js/tq/a' + z + '" style="width:18px;height:18px;vertical-align:middle;" title="' + w + '" />';
		}
		return '';
	}, parsePm: function(p){
		if(p){
			var k = p > 50 ? (p > 100 ? (p > 150 ? (p > 200 ? (p > 300 ? 5 : 4) : 3) : 2) : 1) : 0, t = ['优', '良', '轻度污染', '中度污染', '重度污染', '严重污染'], b = ['Green', '#AFDB00', 'Orange', 'Red', 'Violet', '#600'], c = ['#fff', '#666', '#fff', '#fff', '#fff', '#fff'], d = 'display: inline-block; padding: 0px 4px; height: 18px; line-height: 18px;';
			return '<a style="' + d + ' background: ' + b[k] + '; color: ' + c[k] + ';" title="今日空气质量指数(AQI)：' + p + '" href="http://news.fjsen.com/weather.htm" target="_blank">' + t[k] + '</a>';
		}
		return '';
	}, parseWarning: function(w){
		if(typeof w == 'object' && w[0].warningtxt){
			var ww = w[0].warningtxt, n = -1, m = -1, t = ['台风', '暴雨', '暴雪', '寒潮', '大风', '沙尘暴', '高温', '干旱', '雷电', '冰雹', '霜冻', '大雾', '霾', '道路结冰'], a = ['白色', '蓝色', '黄色', '橙色', '红色'], b = ['#fff', 'Blue', 'Yellow', 'Orange', 'Red'], c = ['#666', '#fff', '#666', '#fff', '#fff'], d = 'display: inline-block; padding: 0px 4px; height: 18px; line-height: 18px;';
			for(var i in t) if(ww.indexOf(t[i]) > -1){
				n = i;
				break;
			}
			for(var i in a) if(ww.indexOf(a[i]) > -1){
				m = i;
				break;
			}
			if(n > -1 && m > -1) return '<a style="' + d + ' background: ' + b[m] + '; color: ' + c[m] + ';" title=" ' + ww + '" href="' + w[0].warningurl.replace('www.weather.com.cn', 'weather.fjsen.com') + '" target="_blank">' + t[n] + '</a>';
		}
		return '';
	}, parseData:function(json){
		var w;
		try{
			w = JSON.parse(json.weather);
		}catch(e){
			eval('w=' + json.weather);
		}
		Weather.Data.du = Weather.parseDu(w.temp0);
		Weather.Data.img = Weather.parseImg(w.weather0);
		Weather.Data.pm = Weather.parsePm(w.pm25);
		Weather.Data.warning = Weather.parseWarning(w.warning);
	}, toSelector:function(){
		$(Weather.Selector).each(function(){
			var t = $(this), d = t.attr('data') || '{city}：{img} {du} <em>|</em> 空气：{pm} {warning}';
			t.html(d.replace('{city}', Weather.City).replace('{img}', Weather.Data.img).replace('{du}', Weather.Data.du).replace('{pm}', Weather.Data.pm).replace('{warning}', Weather.Data.warning));
		});
	}
};

var ToGbk = {
	Status: 0, CookieName: 'jianfan', Toggle: function(){
		ToGbk.Status = ToGbk.Status ? 0 : 1;
		Cookie(ToGbk.CookieName, ToGbk.Status);
		ToGbk.Start();
		return ToGbk.TextName();
	}, TextName: function(){
		return ToGbk.Status ? '簡體' : '繁体';	
	}, Load: function(){
		if(Cookie(ToGbk.CookieName) == 1){
			ToGbk.Status = 1;
		}
	}, LoadBig: function(){
		if(ToGbk.Status == 1){
			ToGbk.Start();
		}
	}, Start: function(){
		if(typeof $JFgbk == 'undefined') $.cachedScript('http://www.fjsen.com/js/big5-or-gbk.js').done(function(){
			ToGbk.RunBody();
		});
		else ToGbk.RunBody();
	}, RunBody: function(){
		ToGbk.Run(document.body);
		document.title = ToGbk.Text(document.title);
	}, Run: function(o){
		if(o && o.childNodes){
			var s = o.childNodes;
			for(var i = 0; i < s.length; i++){
				var c = s.item(i);
				if('||BR|HR|TEXTAREA|'.indexOf('|' + c.tagName + '|') > -1) continue;
				if(c.title & c.title != '') c.title = ToGbk.Text(c.title);
				if(c.alt & c.alt != '') c.alt = ToGbk.Text(c.alt);
				if(c.tagName == 'INPUT' & c.value !='' && c.type != 'text' && c.type != 'hidden') c.value = ToGbk.Text(c.value);
				if(c.nodeType == 3) c.data = ToGbk.Text(c.data);
				else ToGbk.Run(c);
			}
		}	
	}, Text: function(s){
		var i = 0, j, ss = '';
		if(s && s.length > 0){
			for(var i = 0; i < s.length; i++){
				if(s.charCodeAt(i) > 10000){
					j = ToGbk.Status ? $JFgbk.indexOf(s.charAt(i)) : $JFbig5.indexOf(s.charAt(i));
					if(j > -1){
						ss += (ToGbk.Status ? $JFbig5.charAt(j) : $JFgbk.charAt(j));
						continue;
					}
				}
				ss += s.charAt(i);
			}
		}
		ss = ss.replace(/一國兩製/ig, '一國兩制');
		return ss;
	}
};

var Cookie = function(name, value, expires, domain, path){
	if(typeof value == 'undefined'){
		var a, b = document.cookie.split(/\s*;\s*/);
		for(var i = 0; i < b.length; i++){
			var a = b[i].split(/\s*=\s*/);
			if(name == a[0]) return unescape(a[1]);
        }
		return null;
	}
	var s = name + '=' + escape(value) + ';';
	if(typeof(expires) == 'number') s += 'expires=' + ((function(){
		var d = new Date();
		d.setTime(d.getTime() + (expires * 1000));
		return d;
	})()).toGMTString() + ';';
	if(typeof(domain) == 'string') s += 'domain=' + domain + ';';
	if(typeof(path) == 'string') s += 'path=' + path + ';';
	document.cookie = s;
};

Date.prototype._format = function(f){
	f || (f = '{y}-{m}-{d} {h}:{i}:{s}');
	var d = this, a = function(b){
		return b.toString().replace(/^(\d)$/, "0$1");
	}, c = {y: d.getFullYear(), m: d.getMonth() + 1, mm: a(d.getMonth() + 1), d: d.getDate(), dd: a(d.getDate()), h: d.getHours(), i: d.getMinutes(), s: d.getSeconds(), day: d.getDay(), week: '星期' + ['日', '一', '二', '三', '四', '五', '六'][d.getDay()], nongli: d._nls()};
	return f.replace(/\{([^\}]+)\}/ig, function(a, b){
		return c[b];
	});
};

Date.prototype._nls = function(){
	var a = ['十', '一', '二', '三', '四', '五', '六', '七', '八', '九', '十', '冬', '腊', '正'], b = ['初', '十', '廿', '卅', ''], c = this._nl();
	return '' + (c.month == 1 ? a[13] : a[Math.floor(c.month)]) + '月' + (c.day == 10 ? b[0] : b[Math.floor(c.day / 10)]) + a[Math.floor(c.day % 10)];
};

Date.prototype._nl = function(){
	var d = new Date(this.getFullYear(), this.getMonth(), this.getDate()), a= [0x04bd8,0x04ae0,0x0a570,0x054d5,0x0d260,0x0d950,0x16554,0x056a0,0x09ad0,0x055d2,0x04ae0,0x0a5b6,0x0a4d0,0x0d250,0x1d255,0x0b540,0x0d6a0,
	0x0ada2,0x095b0,0x14977,0x04970,0x0a4b0,0x0b4b5,0x06a50,0x06d40,0x1ab54,0x02b60,0x09570,0x052f2,0x04970,0x06566,0x0d4a0,0x0ea50,0x06e95,0x05ad0,0x02b60,0x186e3,0x092e0,0x1c8d7,0x0c950,0x0d4a0,0x1d8a6,0x0b550,
	0x056a0,0x1a5b4,0x025d0,0x092d0,0x0d2b2,0x0a950,0x0b557,0x06ca0,0x0b550,0x15355,0x04da0,0x0a5d0,0x14573,0x052d0,0x0a9a8,0x0e950,0x06aa0,0x0aea6,0x0ab50,0x04b60,0x0aae4,0x0a570,0x05260,0x0f263,0x0d950,0x05b57,
	0x056a0,0x096d0,0x04dd5,0x04ad0,0x0a4d0,0x0d4d4,0x0d250,0x0d558,0x0b540,0x0b5a0,0x195a6,0x095b0,0x049b0,0x0a974,0x0a4b0,0x0b27a,0x06a50,0x06d40,0x0af46,0x0ab60,0x09570,0x04af5,0x04970,0x064b0,0x074a3,0x0ea50,
	0x06b58,0x055c0,0x0ab60,0x096d5,0x092e0,0x0c960,0x0d954,0x0d4a0,0x0da50,0x07552,0x056a0,0x0abb7,0x025d0,0x092d0,0x0cab5,0x0a950,0x0b4a0,0x0baa4,0x0ad50,0x055d9,0x04ba0,0x0a5b0,0x15176,0x052b0,0x0a930,0x07954,
	0x06aa0,0x0ad50,0x05b52,0x04b60,0x0a6e6,0x0a4e0,0x0d260,0x0ea65,0x0d530,0x05aa0,0x076a3,0x096d0,0x04bd7,0x04ad0,0x0a4d0,0x1d0b6,0x0d250,0x0d520,0x0dd45,0x0b5a0,0x056d0,0x055b2,0x049b0,0x0a577,0x0a4b0,0x0aa50,
	0x1b255,0x06d20,0x0ada0], b = function(y){
		var i, sum = 348;
		for(i = 0x8000; i > 0x8; i >>= 1) sum += (a[y - 1900] & i) ? 1 : 0;
		return sum + c(y);
	}, c = function(y){
		if(e(y)) return (a[y - 1900] & 0x10000) ? 30 : 29;
		return 0;
	}, e = function(y){
		return a[y - 1900] & 0xf;
	}, f = function(y, m){
		return (a[y - 1900] & (0x10000 >> m)) ? 30 : 29;
	}, g = function(d){
		var i, l = 0, t = 0, L = {}, k = new Date(1900, 0, 31), o = (d - k) / 86400000;
		L.daycyl = o + 40;
		L.moncyl = 14;
		for(i = 1900; i < 2050 && o > 0; i++){
			t = b(i);
			o -= t;
			L.moncyl += 12;
		}
		if(o < 0){
			o += t;
			i--;
			L.moncyl -= 12;
		}
		L.year = i;
		L.yearcyl = i-1864;
		l = e(i);
		L.isleap = false;
		for(i = 1; i < 13 && o > 0; i++){
			if(l > 0 && i == (l + 1) && L.isleap == false){
				--i;
				L.isleap = true;
				t = c(L.year);
			}else t=f(L.year, i);
			if(L.isleap == true && i == (l + 1)) L.isleap = false;
			o -= t;
			if(L.isleap == false) L.moncyl++;
		}
		if( o==0 && l > 0 && i == l + 1){
			if(L.isleap) L.isleap = false;
			else L.isleap = true;
			--i;
			--L.moncyl;
		}
		if(o < 0){
			o += t;
			--i;
			--L.moncyl;
		}      
		L.month = i;
		L.day = o + 1;
		return L;
	};
	return g(d);
};
